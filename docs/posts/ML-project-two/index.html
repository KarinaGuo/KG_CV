<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-04-25">

<title>Karina Guo - Project on Machine Learning and Leaf Trait Pt. 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Karina Guo</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/KarinaGuo" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/dandy_gumnut" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/crunchy_dandelion/" rel="" target=""><i class="bi bi-instagram" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Project on Machine Learning and Leaf Trait Pt. 2</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">code</div>
                <div class="quarto-category">project</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 25, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="using-machine-learning-to-link-climate-phylogeny-and-leaf-area-in-eucalypts-through-a-50-fold-expansion-of-current-leaf-trait-datasets-part-2" class="level2">
<h2 class="anchored" data-anchor-id="using-machine-learning-to-link-climate-phylogeny-and-leaf-area-in-eucalypts-through-a-50-fold-expansion-of-current-leaf-trait-datasets-part-2">Using Machine Learning to Link Climate, Phylogeny and Leaf Area in Eucalypts Through a 50-fold Expansion of Current Leaf Trait Datasets <em>Part 2</em></h2>
<p>This is Part 2 of 2, here I analyse my dataset from the last part to explore two key questions</p>
<blockquote class="blockquote">
<p>To look at the source code, feel free to check out my <a href="https://github.com/KarinaGuo/Machine_Learning_in_Computer_Vision_for_Leaf_Traits">GitHub</a></p>
</blockquote>
<p>
</p><p>&nbsp;</p>
<p>
</p><section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<ul>
<li><p>Project explored how leaf traits shift across the Australian climate and how phylogeny shaped leaf traits</p></li>
<li><p>Found that leaf area was positively associated with mean annual precipitation</p></li>
<li><p>Saw a strong variation in the trait-climate relationship was seen within species</p></li>
<li><p>From the shallowest depths of this phylogeny to the deepest, i.e.&nbsp;from species to genera, there was an overall increase in the mean slope of the association between leaf area and precipitation</p></li>
<li><p>Saw was at ~8.5 MYA there was a rapid convergence to the overall slope hypothesised to be due to gene flow ceasing</p></li>
</ul>
<p>
</p><p>&nbsp;</p>
<p>
</p></section>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>In this part of my project I wanted to see how the leaf trait changed across 1. Climate and 2. Phylogeny. Like mentioned in my last post, I could investigate how the trait changed in congruence with each other because of the site of the dataset.</p>
<p><br></p>
<p>In summary, the questions and hypothesise I proposed prior to the project were:</p>
<ol type="1">
<li><p>How do leaf traits shift across the Australian climate?<br>
<em>I hypothesise that leaf area and largest in-circle area will correlate positively with mean annual precipitation and temperature</em></p></li>
<li><p>To what extent does phylogeny shape leaf traits?<br>
<em>I hypothesise that gene flow will resolve in large trait variability at a shallow phylogenetic level (within species), which will gradually resolve to a trait-climate relationship at deeper levels (for example, among species).</em></p></li>
</ol>
<p>
</p><p>&nbsp;</p>
<p>
</p></section>
<section id="context" class="level3">
<h3 class="anchored" data-anchor-id="context">Context</h3>
<p>To really understand why I was asking these questions, a bit of context is needed.</p>
<p>Firstly, leaf area. As many of you readers are probably well aware of, leaves are the fundamental units of photosynthesis. And because of this, they have a vast range of impacts at different levels of scales. From affecting the carbon cycle around the globe, to influencing species interaction at an individual level. Therefore, as a better understanding of leaf trait variation can result in better predictions and models.</p>
<p>We know that, leaf traits, such as leaf area, are tied to their environment. This may come in the form of a constraint, where a climatic variable may result in the trait being no bigger or smaller than a certain size (e.g., see <a href="https://doi.org/10.1126/science.aal4760">Wright et al.&nbsp;2017</a>, <a href="https://doi.org/10.2307/177103">Guo et al.&nbsp;2000</a>, <a href="https://doi.org/10.1007/s004420050725">Cornelissen 1999</a>). For instance, leaf area has been found to increase from dry to wet environments and from colder to hotter climates. And this may have been due to leaf area being linked to thermal regulation. Where a more effective thermal regulation and reduced water loss is found in leaves that are smaller, particularly those that are more narrow. However, this trend isnâ€™t always this simple and can vary at a geographic and taxonomic scale. As such, my study, for the first time, looks at this trend within every species of eucalypts (<em>Angohphora</em>, <em>Corymbia</em>, <em>Eucalyptus</em>) in detail for <em>all</em> of Australia. <strong>In particular I looked at eucalypt leaf traits of Australia, and how they varied against mean annual precipitation and climate</strong></p>
<p>But what I found more interesting in this study was looking at this how evolutionary history played an influence on the relationship between trait and climate. <strong>As such, I aimed to investigate how this trait-climate trend changed within and across different phylogenetic classifications, such as species, subgenera and genera.</strong> Existing literature acknowledges that phylogeny and contemporary demography, including intraspecific gene flow, may result in this trait-climate trend within species being weaker, unrelated, or even following opposite directions to that reported among species. For example, gene flow between two populations may hinder the adaptation of leaf traits to their local environment, causing the trait-climate trend to diverge from the expected trend. On top of this, an individualâ€™s evolutionary history may constrain phenotype and local adaptive capacity. However, current literature is unable to fully understanding these factors, possibly due to the limitations of current datasets generated using traditional methods.</p>
<p>My study places itself in a unique position with its use of the machine learning models detailed previously. With its application, I was able to create a comprehensive dataset that spans various taxonomic levels across Australia. By pairing this dataset with a fully resolved phylogenetic tree (<a href="https://doi.org/10.1071/SB18015">Thornhill et al.&nbsp;2019</a>), I could link microevolution to macroevolution, and ask the questions I posed prior.</p>
<table class="table">
<tbody>
<tr class="odd">
<td><img src="Traditional_distribution.JPG" class="img-fluid"></td>
<td><img src="ML_distribution.JPG" class="img-fluid"></td>
</tr>
</tbody>
</table>
<p><em>Note: As a preface, the following sections will focus on how leaf area varied against mean annual precipitation as that were the most interesting findings of all traits and climatic variables.</em></p>
<p>
</p><p>&nbsp;</p>
<p>
</p></section>
<section id="results" class="level3">
<h3 class="anchored" data-anchor-id="results">Results:</h3>
<p><strong>We found that leaf area was positively associated with mean annual precipitation.</strong> This aligned to what was found in other studies of eucalypts. However, when compared to a <a href="https://doi.org/10.1126/science.aal4760">study</a> that looked at all taxa globally, we saw that eucalypts had a weaker and shallower slope.</p>
<table class="table">
<colgroup>
<col style="width: 48%">
<col style="width: 52%">
</colgroup>
<tbody>
<tr class="odd">
<td><img src="Trait-climate_WrightsDatasets.JPG" class="img-fluid" alt="Eucalypt trait-climate relationship compared to all taxa"></td>
<td><img src="Trait-climate_OtherDatasets.JPG" class="img-fluid" width="534" alt="Trait-climate relationship compared to other datasets"></td>
</tr>
</tbody>
</table>
<p>When then looked at how evolutionary history impacted the trait-climate relationship, i.e.&nbsp;the slope of our models. We saw that when we took a mean value within species, this resulted in the slope being greater and better reflected those of other studies (<a href="https://doi.org/10.1038/s41597-021-01006-6">Falster et al.&nbsp;2021</a>, <a href="https://doi.org/10.1126/science.aal4760">Wright et al.&nbsp;2017</a>). However, when species was added as a <em>random effect</em> we saw the opposite, a smaller slope. <strong>In essence, this meant that a strong variation in the trait-climate relationship was seen within species</strong>. A similar analysis was then done at different phylogenetic classifications including subgenera and genera. When looking at subgenera, we got the mean trait value within each slope and used that to see how the leaf trait changed against precipitation. And, as a result, we saw a dramatically greater slope (closer to that of other analyses), than in comparison to the species level. Likewise at the genera level, we also saw a greater slope, though less significantly than subgenera. <strong>In summary, from the shallowest depths of this phylogeny to the deepest, i.e.&nbsp;from species to genera, there was an overall increase in the mean slope of the association between leaf area and precipitation.</strong></p>
<p>Furthermore, our machine learning method also allowed us to look at this model throughout the whole span of time of the phylogeny. We know that the average trait-climate slope of species is roughly at 0.2, and that the overall slope of eucalypts is 0.4 (i.e.&nbsp;no grouping). However, current literature is unable to answer what happens at these two points? Well this is where my massive dataset comes in. Using Thornhillâ€™s resolved phylogenetic tree, we separated the entire age of the tree into 20 separate intervals. At each time interval, tips that had split prior to the point were kept as individual unique lineages, while those that had split after the time interval was merged by common ancestry into a single â€˜lineageâ€™. For instance, the 1st interval was at 0 million years ago and included every tip of the tree as a lineage (418 lineages). Whereas, at the 3rd interval, 8.57 million years ago, 77 lineages were present. Running the statistical model at each lineage, and generating the overall slope. We then generate the following graph. <strong>And what we saw was at ~8.5 MYA there was a rapid convergence to the overall slope</strong> (akin to the species to subgenera separation mentioned prior). In which, I hypothesised to be due to gene flow. Where, at this point, gene flow ceases and we see that rapid convergence of the slope to the genus level.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Phylogeny.JPG" class="img-fluid figure-img" alt="Trait-climate relationship across the phylogenetic tree"></p>
<figcaption class="figure-caption">The phylogenetic tree was split at 20 intervals at evenly spaced time periods. The mean slope within the lineages at each time point was calculated. For example, 0 MY had each species as a random effect, whereas 55 MY had two groups of species, corresponding to the deepest branch among the eucalypts. A convergence towards an approximate average slope was observed roughly 8.5 MY.</figcaption>
</figure>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>